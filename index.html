<script>
  // CTF için sabit değerler (gerçekte frontend'e API key koymayız)
  const API     = "https://bulut-kasifleri-api.cinar0arda.workers.dev?minPuan=80";
  const API_KEY = "KASIF-12345-SECRET";

  const btn = document.getElementById('getDataBtn');
  const out = document.getElementById('output');

  btn.addEventListener('click', async () => {
    btn.disabled = true;
    out.textContent = 'Yükleniyor...';
    try {
      const res = await fetch(API, { headers: { "x-api-key": API_KEY } });
      if (!res.ok) throw new Error('API hata: ' + res.status);
      const json = await res.json();

      // Basit tablo render (istersen düz JSON da gösterebilirsin)
      const rows = json.data || [];
      if (!rows.length) { out.textContent = 'Kayıt bulunamadı.'; return; }

      const table = document.createElement('table');
      table.style.borderCollapse = 'collapse';
      table.style.width = '100%';

      const headers = ['id','ad','soyad','puan'];
      const thead = document.createElement('thead');
      const trh = document.createElement('tr');
      headers.forEach(h => {
        const th = document.createElement('th');
        th.textContent = h;
        th.style.border = '1px solid #1f2937';
        th.style.padding = '8px';
        th.style.textAlign = 'left';
        trh.appendChild(th);
      });
      thead.appendChild(trh);
      table.appendChild(thead);

      const tbody = document.createElement('tbody');
      rows.forEach(r => {
        const tr = document.createElement('tr');
        headers.forEach(h => {
          const td = document.createElement('td');
          td.textContent = r[h];
          td.style.border = '1px solid #1f2937';
          td.style.padding = '8px';
          tr.appendChild(td);
        });
        tbody.appendChild(tr);
      });
      table.appendChild(tbody);

      out.innerHTML = '';
      out.appendChild(table);
    } catch (e) {
      out.textContent = 'Hata: ' + e.message;
    } finally {
      btn.disabled = false;
    }
  });
</script>
